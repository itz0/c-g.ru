# Программа обработчик AJAX поиска сайта c-g.ru

<br>

## Что делает эта программа, какой принцип работы?
эта программа позволяет быстро получить информацию о доступных книгах на сайте c-g.ru, путем запроса через поиск сайта списка isbn кодов или названия книг

*скорость обработки списка из 500 ISBN кодов - около 1 минут*

<br>

## Для кого эта программа?
для фрилансеров и всех кто работает с большим объемом книг

<br>

## Системные требования и ограничения программы
программа гарантированно работает на ОС Windows 10 x64, 32-битный билд доступен только в ранних версиях (которые не рекомендуется использовать), интернет желательно быстрый, проводной..

<br>

## По поводу вирусов, троянов и закрытого кода
данная программа гарантированно ***мною*** не содержит в себе вирусов, троянов и прочего малваря, кто сомневается можете запускать из песочницы, написана на чистом питоне и скомпилирована на gcc последних версий, по известным причинам я не публикую исходный код программы также как не использую реальное название сайта в данном проекте и его описании..

<br>

## Состав дистрибутива программы
в дистрибутив программы входят два файла и необходимые для работы программы:
- **c-g-isbn-xlsx-v3.1-high-load-x64.exe** - исполняемый файл для поиска и обработки isbn кодов из файла isbn.xls

<br>

## ВНИМАНИЕ: 
## СМОТРИТЕ АКТУАЛЬНОЕ ОБУЧАЮЩЕЕ ВИДЕО ИЗ АРХИВА c-g-readme.zip В 2 РЕЛИЗЕ ПРОГРАММЫ!!!

<br>

## Руководство по использованию программы (данная инструкция предназначена только для первой версии программы 1.0.0.0):

<br>

1. Скачайте и распакуйте архив с программой из [релизов](https://github.com/itz0/c-g.ru/releases/) под Вашу ОС
2. Зайдите в распакованный каталог и запустите исполняемый файл **c-g-isbn.exe** который предназначен для поиска и обработки isbn кодов из файла isbn.txt
после запуска программы, дождитесь окончания её работы нажмите клавишу **Enter**, программа сама создаст необходимые для ее работы файлы, в частности:
- **isbn.txt** - текстовой файл со списком isbn кодов для поиска и обработки книг по их isbn кодам
- **books.txt** - текстовой файл со списком названий книг для поиска и обработки книг по их названию
- **log.txt** - текстовой файл, в который программа записывает технические этапы своей работы
- **headers.txt** - текстовой файл, в который *только в случае ошибок* необходимо будет записать новые headers из броузера, см. ниже: Возможные ошибки
3. На данном этапе проверьте, что после запуска программы у Вас появились в каталоге следующие csv файлы, откройте данные файлы в Excel двойным щелчком на каждом из них и проверьте, что эти файлы не пустые а содержат данные о книгах:
- **c-g.ru_books.csv** - файл таблица, в которой содержится вся информация о найденных книгах на сайте c-g.ru
- **c-g.ru_books_found_isbns.csv** - файл таблица, в которой содержится вся информация о найденных книгах в виде сопоставления поискового запроса и Book ID (IDS)

Примечание: Book ID (IDS) - является уникальным номером книги на сайте c-g.ru, по которому также можно произвести поиск добавив данные коды списком в файл isbn.txt и запустив программу **c-g-isbn.exe**

<br>

4. На данном этапе если данные о запрошенных книгах в открытых csv файлах пристутсвуют, значит ошибок с соединением нет и программа работает, теперь **закройте все открытые CSV файлы программы, это важно!!**

Примечание: если открытые csv файлы не были созданы программой или их содержимое оказалось пустое - см. ниже: **Возможные ошибки**

<br>

5. Откройте в текстовом редакторе файл isbn.txt добавьте в него столбиком **свои ISBN коды для поиска** по одному ISBN коду на одну строку в таком же виде, в котором они там присутствуют, к примеру:
```
9785705739912
9785705739325
9785413016138
9785445304401
9785462017995
```

Примечание: исходное содержимое файлов isbn.txt и books.txt можно и нужно удалить, т.к. при первом запуске а также в случае отстутствия данных файлов программа сама создает эти шаблоны и проверяет по ним свою работу, в дальнейшем в эти файлы мы записываем свои данные в isbn.txt - строго isbn коды, а в books.txt строго текстовое название книги - желательно без знаков припинания и прочих спец. символов, и самое главное **строго один запрос на одну строку!**

Примечание: для удобства заполнения текстовых файлов, к примеру файла isbn.txt рекомендую заранее подготовить список isbn кодов в Excel и затем скопировать всё содержимое столбца с isbn кодами и вставить их как есть в открытый файл isbn.txt в блокноте, сохранить его и закрыть

<br>

6. Запустите снова исполняемый файл **c-g-isbn.exe** который предназначен для поиска и обработки isbn кодов из файла isbn.txt, после запуска программы, дождитесь окончания её работы и нажмите клавишу **Enter**, после окончания своей работы программа создаст данные csv файлы, которые и являются результатом её работы:
- **c-g.ru_books.csv** - файл таблица, в которой содержится вся информация о найденных книгах на сайте c-g.ru
- **c-g.ru_books_found_isbns.csv** - файл таблица, в которой содержится вся информация о найденных книгах в виде сопоставления поискового запроса и Book ID (IDS)

<br>

## в разделе [Wiki](https://github.com/itz0/c-g.ru/wiki/%D0%9E-%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B5) можно посмотреть онлайн наглядное видео по работе с программой, эти видео также присутствует в архиве в релизах под названием [c-g-readme.zip](https://github.com/itz0/c-g.ru/releases/download/1.0.0.0/c-g-readme.zip)


---

# Возможные ошибки - большинство ошибок при запуске и работе программы связанны c двумя важными моментами:

## 1. Не закрытые CSV файлы 
- **не забывайте закрывать CSV файлы программы при запуске и во время работы программы, а также не открывайте их пока программа работает:**
- **c-g.ru_books.csv** - файл таблица, в которой содержится вся информация о найденных книгах на сайте c-g.ru
- **c-g.ru_books_found_isbns.csv** - файл таблица, в которой содержится вся информация о найденных книгах в виде сопоставления поискового запроса и Book ID (IDS)

## 2. Не подходящие headers
- **сайт c-g.ru использует защиту Incapsula пока для её обхода требуется выполнить несколько условий:**
- иметь белый, пушистый русский ip адрес, проверьте не выскакивает ли у Вас капча при входе на сайт c-g.ru и если выскакивает, то у Вас не подходящий ip адрес..
- скопировать свежие headers из Вашего броузера и вставить их в файл headers.txt программы, как это сделать рассказываю в этом **[видео](https://streamable.com/evo4rh)**

## _обо всех остальных ошибках в работе программ прошу Вас сообщать мне, обязательно с логом log.txt и оригинальными файлами запросов: isbn.txt или books.txt_


---

# Известные на данный момент баги второй версии программы:

### 1. Если при поиске книги на сайте c-g.ru находится 2 книги и более по одному isbn коду, то программа может "задвоить" данные книги в выходном отчете, а также в отчете могут "поплыть" все goods_id и isbn коды (первые два столбца отчета), остальные данные будут верны начиная с столбца "bookid" книги.

## временное решение данного бага - ВСЕГДА СВЕРЯЙТЕ НАИМЕНОВАНИЕ КНИГ в Excel посредством ВПР функции, рекомендую делать это всегда после использования данной программы!!

### 2. При поиске на сайте c-g.ru, программа иногда получает неверные данные с сайта, что приводит к внезапной ошибке и закрытию программы на 2 этапе её работы  

## временное решение данного бага - только вручную найти тот isbn код на котором программа закрывается, путем разбития входных данных на большое кол-во файлов с меньшим кол-вом строк и прогонять данные файлы отдельно пока не будет найден тот файл с isbn кодом на котором программа закрывается.. принцип поиска надеюсь ясно объяснил

### все данные баги планирую исправить в 3 версии программы, когда дойдут руки и будет свободное время..
