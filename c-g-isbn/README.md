# Программа обработчик API AJAX поиска сайта c-g.ru

<br>

## Что делает эта программа, какой принцип работы?
эта программа позволяет быстро получить информацию о доступных книгах на сайте c-g.ru, путем запроса через поиск сайта списка isbn кодов или названия книг

*скорость обработки списка из 500 ISBN кодов - около 1 минуты*

<br>

## Для кого эта программа?
для фрилансеров и всех кто работает с большим объемом книг

<br>

## Системные требования и ограничения программы
программа гарантированно работает на ОС Windows 10 x64, 32-битный билд доступен только в ранних версиях (которые не рекомендуется использовать), интернет желательно быстрый, проводной..

<br>

## По поводу вирусов, троянов и закрытого кода
данная программа гарантированно ***мною*** не содержит в себе вирусов, троянов и прочего малваря, кто сомневается можете запускать из песочницы, написана на чистом питоне и скомпилирована на gcc последних версий, по известным причинам я не публикую исходный код программы также как не использую реальное название сайта в данном проекте и его описании..

<br>

## Состав дистрибутива программы
в дистрибутив программы входят два файла и необходимые для работы программы:
- **c-g-isbn-xlsx-v3.1-high-load-x64.exe** - исполняемый файл для поиска и обработки isbn кодов из файла isbn.xlsx
- **isbn.xlsx** - файл пример для демонстрации работы программы и правильного оформления запросов

<br>

## Руководство по использованию программы:

<br>

1. Скачайте и распакуйте архив с программой из [релизов](https://github.com/itz0/c-g.ru/releases/) рекомендую последний релиз для работы только в ОС Windows 7-10 x64
2. Зайдите в распакованный каталог и ознакомьтесь с форматом заполнения файла запроса **isbn.xlsx**, для этого откройте его в excel
3. Закройте файл **isbn.xlsx** и запустите исполняемый файл **c-g-isbn-xlsx-v3.1-high-load-x64.exe** который предназначен для поиска и обработки isbn кодов из файла isbn.xlsx
4. после запуска программы **c-g-isbn-xlsx-v3.1-high-load-x64.exe**, дождитесь окончания работы программы, следуя сообщениям вывода консоли и нажмите клавишу **Enter**, программа сама создаст необходимые для ее работы файлы, в частности:
- **chitai-gorod.ru_books.xlsx** - excel файл, в котором содержится вся информация о найденных книгах
- **headers.txt** - текстовой файл, в который *только в случае ошибок* необходимо будет записать новые headers из броузера, см. ниже: Возможные ошибки
5. Проверьте результат в полученном файле **chitai-gorod.ru_books.xlsx** открыв его в excel, в частности должны быть заполненны все поля включая ссылки на книги и заглавные фото книг..

Примечание: 
1. если файл **chitai-gorod.ru_books.xlsx** не был создан или программа закрылась с ошибкой - см. ниже: **Возможные ошибки**
2. Book ID (IDS) - является уникальным номером книги на сайте c-g.ru, его можно использовать при поиске на сайте c-g.ru также как и isbn код.

### рекомендую посмотреть небольшое обучающее видео из архива [c-g-readme.zip](https://github.com/itz0/c-g.ru/releases/download/2.0.0.0/c-g-readme-release-2.0.zip)

<br>

## Возможные ошибки - большинство ошибок при запуске и работе программы связанны c двумя важными моментами:

### 1. Не закрытые файлы 
- **не забывайте закрывать XLSX файлы программы при запуске и во время работы программы, а также не открывайте их пока программа работает:**
- **isbn.xlsx** - файл запроса информации в excel
- **chitai-gorod.ru_books.xlsx** - файл excel, в котором записывается вся информация о найденных книгах с сайта c-g.ru

### 2. Не подходящие headers
- **сайт c-g.ru использует защиту Incapsula пока для её обхода требуется выполнить несколько условий:**
- иметь белый, пушистый русский ip адрес, проверьте не выскакивает ли у Вас капча при входе на сайт c-g.ru и если выскакивает, то у Вас не подходящий ip адрес..
- скопировать свежие headers из Вашего броузера и вставить их в файл headers.txt программы, как это сделать рассказываю в этом **[видео](https://streamable.com/evo4rh)**

### Обо всех остальных ошибках в работе программ прошу Вас сообщать мне, обязательно с оригинальным файлом запроса isbn.xlsx

<br>

## Известные на данный момент баги:

1. Если при поиске книги на сайте c-g.ru найдутся 2 книги и более по одному isbn коду, то программа может "задвоить" данные книги в файле вывода **chitai-gorod.ru_books.xlsx**, а также могут "поплыть" некоторые goods_id и isbn коды (первые два столбца отчета), решение:  
**ВСЕГДА СВЕРЯЙТЕ НАИМЕНОВАНИЕ КНИГ ПОЛУЧЕННЫХ В РЕЗУЛЬТАТЕ РАБОТЫ ПРОГРАММЫ С ОРИГИНАЛЬНЫМ ЗАПРОСОМ (НАИМЕНОВАНИЕМ) - в Excel посредством ВПР функции либо используя мою программу [String compare](https://github.com/itz0/sc)**

2. При поиске на сайте c-g.ru, программа иногда получает неверные данные с сайта, что приводит к внезапной ошибке и закрытию программы на 2 этапе её работы, решение:  
только вручную найти тот isbn код на котором программа закрывается, путем разбития входных данных на большое кол-во файлов (isbn.xlsx) с меньшим кол-вом строк и "прогонять" данные файлы программой пока не будет найден файл с "битым isbn" кодом на котором программа закрывается.. принцип поиска надеюсь ясно объяснил =)
